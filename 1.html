<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<title>Lịch Giúp Lễ</title>
<style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #555; padding: 8px; text-align: center; }
    select { width: 130px; margin: 2px 0; }
    button { padding: 10px 16px; margin-top: 20px; font-size: 16px; cursor: pointer; }
</style>
</head>
<nav style="
    width: 100%;
    background: #2b63c6;
    padding: 12px 0;
    display: flex;
    justify-content: center;
    gap: 40px;
    font-family: Arial, sans-serif;
">
    <a href="index.html" style="color: white; font-size: 18px; text-decoration: none;">Trang Chủ</a>
    <a href="1.html" style="color: white; font-size: 18px; text-decoration: none;">bản thử nghiệm</a>
    <a href="2.html" style="color: white; font-size: 18px; text-decoration: none;">Danh Sách Thành Viên</a>
</nav>
<body>

<h2>Bảng Chia Lịch Giúp Lễ</h2>

<table>
    <table>
    <tr>
        <th>Thứ</th>
        <th>Buổi</th>
        <th>Phân Công</th>
    </tr>

    <!-- Thứ Hai -->
    <tr>
        <td rowspan="1">Thứ Hai</td>
        <td>Tối</td>
        <td class="cell" data-id="mon_c"></td>
    </tr>

    <!-- Thứ Ba -->
    <tr>
        <td rowspan="1">Thứ Ba</td>
        <td>Tối</td>
        <td class="cell" data-id="tue_c"></td>
    </tr>

    <!-- Thứ Tư -->
    <tr>
        <td rowspan="1">Thứ Tư</td>
        <td>Tối</td>
        <td class="cell" data-id="wed_c"></td>
    </tr>

    <!-- Thứ Năm -->
    <tr>
        <td rowspan="1">Thứ Năm</td>
        <td>Tối</td>
        <td class="cell" data-id="thu_c"></td>
    </tr>

    <!-- Thứ Sáu -->
    <tr>
        <td rowspan="1">Thứ Sáu</td>
        <td>Tối</td>
        <td class="cell" data-id="fri_c"></td>
    </tr>

    <!-- Thứ Bảy -->
    <tr>
        <td rowspan="2">Thứ Bảy</td>
        <td>Sáng</td>
        <td class="cell" data-id="sat_s"></td>
    </tr>
    <tr>
        <td>Tối</td>
        <td class="cell" data-id="sat_c"></td>
    </tr>

    <!-- Chủ Nhật -->
    <tr>
        <td rowspan="2">Chủ Nhật</td>
        <td>Sáng</td>
        <td class="cell" data-id="sun_s"></td>
    </tr>
    <tr>
        <td>Tối</td>
        <td class="cell" data-id="sun_c"></td>
    </tr>
</table>



<button onclick="downloadWord()">Tải Lịch Xuống File Word</button>

<script>
const names = [
    "Vỹ","Thắng","Vy","Thư","Thương","N.Minh","K.Bình","N.Anh",
    "V.Minh","Quân","Lan","Thảo","Long","H.Anh","Ánh (bé)","Bích",
    "Phong","Phúc","Linh (bé)","Ngà","Trãi","Ánh (lớn)",
    "Nhi","Dũng","Cường","Sấy","Triệu"
];

// tạo dropdown
function makeSelect() {
    let html = "<select>";
    html += `<option value="">---</option>`;
    names.forEach(n => html += `<option>${n}</option>`);
    html += "</select>";
    return html;
}

// gắn dropdown vào các ô
document.querySelectorAll(".cell").forEach(cell => {
    let id = cell.dataset.id;
    let count = (id === "sat_s") ? 2 : 4; 
    for (let i = 1; i <= count; i++) cell.innerHTML += makeSelect() + "<br>";
});


// ===== XUẤT FILE WORD =====
function downloadWord() {
    let content = "<h2>Lịch Giúp Lễ</h2><table border='1' cellspacing='0' cellpadding='6'>";

    document.querySelectorAll("table tr").forEach(tr => {
        content += "<tr>";
        tr.querySelectorAll("td,th").forEach(cell => {
            if (cell.classList.contains("cell")) {
                let selects = [...cell.querySelectorAll("select")].map(s => s.value || "—").join(" – ");
                content += `<td>${selects}</td>`;
            } else {
                content += `<td>${cell.innerText}</td>`;
            }
        });
        content += "</tr>";
    });

    content += "</table>";

    // ===== Thêm dòng chữ cuối trang =====
    content += `
        <br><br>
        <div style="text-align:center; font-style:italic; font-size:16px; margin-top:20px;">
            “Phụng sự Chúa trong niềm vui”
        </div>
        <div style="text-align:center; margin-top:10px; font-size:15px;">
            (Đaminh Saviô)
        </div>
    `;

    let blob = new Blob(['\ufeff', content], { type: 'application/msword' });
    let url = URL.createObjectURL(blob);

    let a = document.createElement("a");
    a.href = url;
    a.download = "lich_giup_le.doc";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}

</script>

</body>
</html>
